---
knit: (function(input_file, encoding) {
  out_dir <- 'docs/R';
  rmarkdown::render(input_file,
    encoding=encoding,
    output_file='multiple-linear-regression.md') })
output: github_document
editor_options:
  chunk_output_type: console
---
  
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=TRUE, fig.path="img/multiple-linear-regression/",
                      fig.width=6, fig.height=4,
                      fig.show='hold', fig.align='center')
options(width=100)
```

# Multiple Linear Regression (MLR)

### [MLR hypotheses](https://online.stat.psu.edu/stat501/lesson/5/5.3)

&nbsp;&nbsp;&nbsp;&nbsp;**Null hypothesis:** The estimated coefficient ($\beta$) for variable *i* is equal to 0.
&nbsp;
<center><i>H<sub>0</sub>: &#946;<sub>i</sub> = 0</i></center>
&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;**Alternative hypothesis:** $\beta_i$ is not equal to 0.
&nbsp;
<center><i>H<sub>A</sub>: &#946;<sub>i</sub> &#8800; 0, </i>or<i> H<sub>A</sub>: &#946;<sub>i</sub> &gt; 0 or &#946;<sub>i</sub> &lt; 0</i></center>
&nbsp;


### [MLR assumptions](https://online.stat.psu.edu/stat501/lesson/7/7.3)

- The predictor and response variables have a **linear relationship**.
- The errors are **independent**, **normally distributed**, and have **equal variances**.

### Loading the data in R

&nbsp;&nbsp;&nbsp;&nbsp;In this example we will be using a dataset provided in [Example 5-1 of the STAT 501 Regression Methods course](https://online.stat.psu.edu/stat501/lesson/5/5.1) that includes data on participant's performance IQ score, brain size, and body size in height & weight.

```{r}
iqsize <- read.table("dat/iqsize.txt", header = TRUE)
```

&nbsp;&nbsp;&nbsp;&nbsp;Now that the dataset is loaded, you can view a brief summary of the dataset using the `summary()` function on the assigned object.

### Fitting a MLR model

&nbsp;&nbsp;&nbsp;&nbsp;To fit a linear regression model we can use the `lm()` function in R where the response variable *PIQ* is to the left of of the `~` and the predictor variables brain size (*Brain*), *Height*, and *Weight* are to the right and separated by `+` as follows:

```{r}
fit.lm <- lm(PIQ ~ Brain + Height + Weight, data = iqsize)
```

### Interpreting the results

&nbsp;&nbsp;&nbsp;&nbsp;Using the `summary()` function we can print out summary statistics of our MLR model.

```{r}
summary(fit.lm)
```

&nbsp;&nbsp;&nbsp;&nbsp;From the summary statistics we can fist note that *PIQ* can be predicted by the variables included in our model as the p-value for the MLR model is below 0.05, although the r<sup>2</sup> is ~3 to say that relationship is weak. Further, the *Brain* and *Height* variables are statistically significant predictors of *PIQ* given by the p-values for their coefficients (`Pr(>|t|)` column) being below 0.05. Conversely, the *Weight* variable is no statistically significant and even close to 1, so we could conclude that the weight of the participant has no relationship with their performance IQ.

### Full code block

```{r eval = FALSE}
# Load the dataset
iqsize <- read.table("dat/iqsize.txt", header = TRUE)

# Fit a linear model
fit.lm <- lm(PIQ ~ Brain + Height + Weight, data = iqsize)

# View the results of the linear model
summary(fit.lm)
```

